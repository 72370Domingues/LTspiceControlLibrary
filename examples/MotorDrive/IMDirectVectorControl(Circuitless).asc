Version 4
SHEET 1 1304 1156
WIRE -1952 -576 -2000 -576
WIRE -1872 -576 -1952 -576
WIRE -1824 -576 -1872 -576
WIRE -1664 -576 -1696 -576
WIRE -1648 -576 -1664 -576
WIRE -1568 -576 -1584 -576
WIRE -1440 -576 -1504 -576
WIRE -1360 -576 -1440 -576
WIRE -1328 -576 -1360 -576
WIRE -1232 -576 -1264 -576
WIRE -2000 -528 -2000 -576
WIRE -1872 -528 -1872 -576
WIRE -1856 -528 -1872 -528
WIRE -1792 -528 -1792 -544
WIRE -1440 -528 -1440 -576
WIRE -1344 -528 -1376 -528
WIRE -1296 -528 -1296 -544
WIRE -1296 -528 -1344 -528
WIRE -976 -512 -1008 -512
WIRE -960 -512 -976 -512
WIRE -880 -512 -896 -512
WIRE -880 -496 -880 -512
WIRE -864 -496 -880 -496
WIRE -848 -496 -864 -496
WIRE -672 -496 -720 -496
WIRE -608 -496 -672 -496
WIRE -1232 -480 -1232 -576
WIRE -1200 -480 -1232 -480
WIRE -1168 -480 -1200 -480
WIRE -1088 -480 -1104 -480
WIRE -1008 -480 -1008 -512
WIRE -1008 -480 -1024 -480
WIRE -608 -480 -608 -496
WIRE -1200 -448 -1232 -448
WIRE -1168 -448 -1200 -448
WIRE -1088 -448 -1104 -448
WIRE -976 -448 -1024 -448
WIRE -864 -448 -976 -448
WIRE -848 -448 -864 -448
WIRE -1008 -416 -1024 -416
WIRE -1872 -400 -1872 -528
WIRE -864 -400 -880 -400
WIRE -848 -400 -864 -400
WIRE -704 -400 -720 -400
WIRE -608 -400 -704 -400
WIRE -1008 -384 -1008 -416
WIRE -976 -384 -1008 -384
WIRE -960 -384 -976 -384
WIRE -880 -384 -880 -400
WIRE -880 -384 -896 -384
WIRE -2656 -368 -2672 -368
WIRE -2640 -368 -2656 -368
WIRE -2448 -368 -2512 -368
WIRE -2304 -368 -2448 -368
WIRE -2272 -368 -2304 -368
WIRE -2192 -368 -2208 -368
WIRE -2176 -368 -2192 -368
WIRE -2000 -368 -2064 -368
WIRE -1952 -368 -2000 -368
WIRE -1904 -368 -1952 -368
WIRE -1712 -368 -1776 -368
WIRE -1696 -368 -1712 -368
WIRE -1568 -368 -1632 -368
WIRE -1440 -368 -1504 -368
WIRE -1360 -368 -1440 -368
WIRE -1328 -368 -1360 -368
WIRE -1232 -368 -1232 -448
WIRE -1232 -368 -1264 -368
WIRE -2192 -336 -2192 -368
WIRE -704 -336 -704 -400
WIRE -2672 -320 -2672 -368
WIRE -1440 -320 -1440 -368
WIRE -1344 -320 -1376 -320
WIRE -1296 -320 -1296 -336
WIRE -1296 -320 -1344 -320
WIRE -2448 -304 -2448 -368
WIRE -2432 -304 -2448 -304
WIRE -2352 -304 -2368 -304
WIRE -2272 -304 -2288 -304
WIRE -2240 -304 -2240 -336
WIRE -2240 -304 -2272 -304
WIRE -2000 -304 -2000 -368
WIRE -2000 -304 -2160 -304
WIRE -928 -304 -944 -304
WIRE -912 -304 -928 -304
WIRE -816 -304 -848 -304
WIRE -800 -304 -800 -384
WIRE -800 -304 -816 -304
WIRE -1136 -272 -1136 -400
WIRE -992 -272 -1136 -272
WIRE -928 -272 -992 -272
WIRE -912 -272 -928 -272
WIRE -816 -272 -848 -272
WIRE -768 -272 -768 -384
WIRE -768 -272 -816 -272
WIRE -2400 -256 -2400 -272
WIRE -2192 -256 -2192 -272
WIRE -2192 -256 -2400 -256
WIRE -1616 -208 -1616 -544
WIRE -1184 -208 -1616 -208
WIRE -1168 -208 -1184 -208
WIRE -1088 -208 -1104 -208
WIRE -816 -208 -1024 -208
WIRE -800 -208 -816 -208
WIRE -1664 -176 -1664 -336
WIRE -1184 -176 -1664 -176
WIRE -1168 -176 -1184 -176
WIRE -1088 -176 -1104 -176
WIRE -944 -144 -1024 -144
WIRE -928 -144 -944 -144
WIRE -928 -128 -928 -144
WIRE -800 -128 -800 -208
WIRE -1136 -80 -1136 -128
WIRE -1120 -80 -1136 -80
WIRE -992 -80 -992 -272
WIRE -992 -80 -1056 -80
WIRE -2608 -16 -2608 -336
WIRE -640 -16 -2608 -16
WIRE -608 -16 -640 -16
WIRE -608 0 -608 -16
FLAG -800 -48 0
FLAG -928 -48 0
FLAG -816 -208 iu
FLAG -944 -144 iw
FLAG -1184 -208 ig1
FLAG -1184 -176 id1
FLAG -1664 -576 ig1*
FLAG -1360 -576 vg1*_p
FLAG -1344 -528 vg1*_i
FLAG -2000 -448 0
FLAG -1712 -368 id1*
FLAG -1360 -368 vd1*_p
FLAG -1344 -320 vd1*_i
FLAG -1200 -480 vg1*
FLAG -1200 -448 vd1*
FLAG -976 -512 vu*
FLAG -976 -448 vv*
FLAG -976 -384 vw*
FLAG -704 -336 0
FLAG -608 80 0
FLAG -640 -16 om
FLAG -672 -496 Tm
FLAG -2656 -368 om*
FLAG -2304 -368 tm*_p
FLAG -2272 -304 tm*_i
FLAG -2672 -240 0
FLAG -1952 -368 tm*
FLAG -864 -496 U
FLAG -864 -448 V
FLAG -864 -400 W
FLAG -928 -304 f2
FLAG -928 -272 pf2
FLAG -816 -304 fd2
FLAG -816 -272 fq2
FLAG -1952 -576 f2*
SYMBOL bv -800 -144 M0
SYMATTR InstName B1
SYMATTR Value V=I(L1)
SYMBOL bv -928 -144 M0
SYMATTR InstName B2
SYMATTR Value V=I(L2)
SYMBOL LTspiceControlLibrary\\CoordinateTransformations\\uw-abTransformation -1024 -256 M0
SYMATTR InstName U2
SYMBOL LTspiceControlLibrary\\CoordinateTransformations\\xyRotation -1104 -256 M0
SYMATTR InstName U4
SYMBOL LTspiceControlLibrary\\Math\\Operands\\neg -1072 -48 M0
SYMATTR InstName U6
SYMBOL sub -1632 -544 R0
SYMATTR InstName U7
SYMBOL Integral -1424 -496 R0
SYMATTR Value T={Tiig1}
SYMATTR InstName U8
SYMBOL Proportional -1552 -544 R0
SYMATTR Value K={Kpig1}
SYMATTR InstName U10
SYMBOL add -1312 -544 R0
SYMATTR InstName U11
SYMBOL voltage -2000 -544 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value PULSE(0 0.5 0 0.1)
SYMBOL sub -1680 -336 R0
SYMATTR InstName U12
SYMBOL Integral -1424 -288 R0
SYMATTR Value T={Tiid1}
SYMATTR InstName U13
SYMBOL Proportional -1552 -336 R0
SYMATTR Value K={Kpid1}
SYMATTR InstName U14
SYMBOL add -1312 -336 R0
SYMATTR InstName U15
SYMBOL LTspiceControlLibrary\\CoordinateTransformations\\xyRotation -1168 -528 R0
SYMATTR InstName U16
SYMBOL LTspiceControlLibrary\\CoordinateTransformations\\ab-uvwTransformation -1088 -528 R0
SYMATTR InstName U17
SYMBOL bv -608 -16 M0
SYMATTR InstName B3
SYMATTR Value V=I(V3)
SYMBOL FerriteBead -928 -512 R270
WINDOW 0 16 0 VTop 2
SYMATTR InstName L1
SYMATTR Value 1n
SYMBOL FerriteBead -928 -384 R270
WINDOW 0 16 0 VTop 2
SYMATTR InstName L2
SYMATTR Value 1n
SYMBOL voltage -608 -496 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value PULSE(0 5 0.5 0.3)
SYMBOL sub -2624 -336 R0
SYMATTR InstName U5
SYMBOL Integral -2336 -272 R0
SYMATTR InstName U3
SYMATTR Value T={Tiom}
SYMBOL add -2256 -336 R0
SYMATTR InstName U19
SYMBOL Proportional -1824 -336 R0
SYMATTR Value K={L2/(M*Np)}
SYMATTR InstName U20
SYMBOL Proportional -2560 -336 R0
SYMATTR Value K={Kpom}
SYMATTR InstName U24
SYMBOL voltage -2672 -336 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V1
SYMATTR Value PULSE(0 150 0.2)
SYMBOL LTspiceControlLibrary\\Motors\\InductionMotor -720 -448 R0
SYMATTR InstName U1
SYMATTR Value R1={R1} R2={R2} M={M} Ll1={Ll1} Ll2={Ll2} Dm={Dm} Jm={Jm} Np={Np}
SYMBOL LTspiceControlLibrary\\CoordinateTransformations\\xy-rpTransformation -848 -352 M0
SYMATTR InstName U33
SYMBOL LTspiceControlLibrary\\Math\\Operands\\div -1888 -400 M180
SYMATTR InstName U30
SYMBOL LTspiceControlLibrary\\Math\\Functions\\limit -2160 -336 R0
WINDOW 3 0 0 Left 2
SYMATTR Value y=-z z={Tmlimit}
SYMATTR InstName U21
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -2160 -320 M90
SYMATTR InstName U22
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -2416 -272 R0
SYMATTR InstName U23
SYMBOL Proportional -1744 -544 R0
SYMATTR Value K={1/M}
SYMATTR InstName U9
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Derivative -1840 -496 R0
SYMATTR Value T={L2/R2}
SYMATTR InstName U18
SYMBOL LTspiceControlLibrary\\Math\\Operands\\add -1808 -544 R0
SYMATTR InstName U25
TEXT -960 -344 Left 2 ;sensor
TEXT -1640 -632 Left 2 ;current controller
TEXT -1224 -632 Left 2 ;coordinate transformation
TEXT -1104 -872 Left 2 !** IM parameters\n.params R1=1 R2=1 M=0.1 Ll1=1m Ll2=1m Dm=10m Jm=10m Np=2\n.params L1=Ll1+M L2=Ll2+M sigma=1-M*M/(L1*L2)
TEXT -1760 -872 Left 2 !** current control parameters\n.params Oci=5000\n.params wi=0.2\n.params Kpig1=sigma*L1*Oci\n.params Tiig1=1/(wi*(1-wi)*Oci)\n.params Kpid1=sigma*L1*Oci\n.params Tiid1=1/(wi*(1-wi)*Oci)
TEXT -2408 -864 Left 2 !** speed control parameters\n.params Ocom=0.1*Oci\n.params wom=0.2\n.params Kpom=Jm*Ocom\n.params Tiom=1/(wom*(1-wom)*Ocom)\n.params Tmlimit=10
TEXT -2688 -472 Left 2 ;speed controller
TEXT -2656 -896 Left 2 !.tran 1.0 startup
TEXT -2696 -936 Left 4 ;Config
TEXT -2736 -992 Left 5 ;IM Direct Vector Control with Magnetic Flux, 2 Currents and Speed Sensing
TEXT -2696 -624 Left 4 ;Control System
TEXT -600 -504 Left 2 ;disturbance torque
TEXT -784 -760 Left 2 ;Analogy between\nElectric Circuit  - Rotating Machinery\nQ: charge - Pm: angle\nI: current - Om: angular velocity\nV: voltage - Tm: torque\nR: resistance - Dm: viscous resistance\nL: inductance - Jm: moment of inertia\nC: capacitance - Km: torsion coefficient
TEXT -760 -288 Left 2 ;f: magnetic flux
TEXT -2344 -240 Left 2 ;antiwindup
